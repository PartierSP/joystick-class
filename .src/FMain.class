' Gambas class file

' Public joy1 As New JoyStick(Me)
Public JoyStickReady As Boolean = True

Public Sub Form_Open()


  Me.Center()

End

Public Sub joy1_OnJoystick()

  'Public Sub tmrJoystick_Timer()

  If Not JoyStickReady Then Return

  With joy1
  cbUp.Value = .UpState
  cbDown.Value = .DownState
  cbRight.Value = .RightState
  cbLeft.Value = .LeftState
  cbButton0.Value = .HoldButton0()
  cbButton1.Value = .HoldButton1()
  cbButton2.Value = .HoldButton2()
  cbButton3.Value = .HoldButton3()
  cbButton4.Value = .HoldButton4()
  cbButton5.Value = .HoldButton5()
  cbButton6.Value = .HoldButton6()
  cbButton7.Value = .HoldButton7()
  cbButton8.Value = .HoldButton8()
  cbButton9.Value = .HoldButton9()
  cbButton10.Value = .HoldButton10()
  cbButton11.Value = .HoldButton11()
  cbButton12.Value = .HoldButton12()
  End With

End

Public Sub Form_Close()

  joy1.Close

End

Public Sub joy1_AxisChange(Id As Integer, Value As Integer)

  Select id
    Case 0
      pbAxis0.Value = ScaleAxis(Value)
    Case 1
      pbAxis1.Value = ScaleAxis(Value)
    Case 2
      pbAxis2.Value = ScaleAxis(Value)
    Case 3
      pbAxis3.Value = ScaleAxis(Value)
    Case 4
      pbAxis4.Value = ScaleAxis(Value)
    Case 5
      pbAxis5.Value = ScaleAxis(Value)
  End Select

End

Public Sub ScaleAxis(Value As Integer) As Float
  
  Dim fOutput As Float
  
  'Axis max travel is -32767 to 32767
  fOutput = (Value + 32767) / 65534
  Debug "Raw: "; Value, "Output: "; fOutput
  Return fOutput
End

