' Gambas class file

Public Joystk3 As JoyStick

Public Sub Form_Open()

  Me.Center()
  
  'Check if Joystk1 is ready.
  If Joystk1.Ready = False Then 
    Message.Warning("Joystick 0 not found.")
  Endif

  'Create another joystick instance for device js3
  Joystk3 = New Joystick(Me, "/dev/input/js3")

  'Check if Joystk3 is ready.
  If Joystk3.Ready = False Then 
    Message.Warning("Joystick 3 not found.")
  Endif

End

Public Sub Form_Close()

  Joystk1.Close
'  joy1.Close

End

Public Sub Joystk1_AxisChange(Id As Integer, Value As Integer)

  Select id
    Case 0
      pbAxis0.Value = ScaleAxis(Value)
    Case 1
      pbAxis1.Value = ScaleAxis(Value)
    Case 2
      pbAxis2.Value = ScaleAxis(Value)
    Case 3
      pbAxis3.Value = ScaleAxis(Value)
    Case 4
      pbAxis4.Value = ScaleAxis(Value)
    Case 5
      pbAxis5.Value = ScaleAxis(Value)
  End Select

End

Public Sub Joystk1_ButtonChange(Id As Integer, Value As Boolean)

  Select id
    Case 0
      cbButton0.Value = Value
    Case 1
      cbButton1.Value = Value
    Case 2
      cbButton2.Value = Value
    Case 3
      cbButton3.Value = Value
    Case 4
      cbButton4.Value = Value
    Case 5
      cbButton5.Value = Value
    Case 6
      cbButton6.Value = Value
    Case 7
      cbButton7.Value = Value
    Case 8
      cbButton8.Value = Value
    Case 9
      cbButton9.Value = Value
    Case 10
      cbButton10.Value = Value
    Case 11
      cbButton11.Value = Value
    Case 12
      cbButton12.Value = Value
  End Select

End

Public Sub ScaleAxis(Value As Integer) As Float

  Dim fOutput As Float

  'Axis max travel is -32767 to 32767
  fOutput = (Value + 32767) / 65534

  Return fOutput

End
